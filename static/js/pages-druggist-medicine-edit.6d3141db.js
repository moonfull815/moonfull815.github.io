(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-druggist-medicine-edit"],{"1dab":function(e,a,t){"use strict";(function(e){var i=t("4ea4");t("c975"),t("b64b"),t("d3b7"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=i(t("5530")),r=t("fa35"),o=e.database(),s="medicine";function u(e){var a={};for(var t in r.validator)e.indexOf(t)>-1&&(a[t]=r.validator[t]);return a}var l={data:function(){var e={medicine_imgs:[],specification_img:[],generic_name:"",medicine_name:"",medicine_type:"",specification_packaging:"",price:null,medicine_form:"",usage_dosage:"",treatment_course:"",manufacturer:"",approval_number:"",production_date:null,valid_until:null,is_on_sale:!0};return{formData:e,formOptions:{},rules:(0,n.default)({},u(Object.keys(e)))}},onLoad:function(e){if(e.id){var a=e.id;this.formDataId=a,this.getDetail(a)}},onReady:function(){this.$refs.form.setRules(this.rules)},methods:{submit:function(){var e=this;uni.showLoading({mask:!0}),this.$refs.form.validate().then((function(a){e.submitForm(a)})).catch((function(){uni.hideLoading()}))},submitForm:function(e){var a=this;o.collection(s).doc(this.formDataId).update(e).then((function(e){uni.showToast({icon:"none",title:"修改成功"}),a.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})})).finally((function(){uni.hideLoading()}))},getDetail:function(e){var a=this;uni.showLoading({mask:!0}),o.collection(s).doc(e).field("medicine_imgs,specification_img,generic_name,medicine_name,medicine_type,specification_packaging,price,medicine_form,usage_dosage,treatment_course,manufacturer,approval_number,production_date,valid_until,is_on_sale").get().then((function(e){var t=e.result.data[0];t&&(a.formData=t)})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})})).finally((function(){uni.hideLoading()}))}}};a.default=l}).call(this,t("a9ff")["default"])},"65a8":function(e,a,t){"use strict";t.r(a);var i=t("1dab"),n=t.n(i);for(var r in i)"default"!==r&&function(e){t.d(a,e,(function(){return i[e]}))}(r);a["default"]=n.a},"69fa":function(e,a,t){"use strict";t.d(a,"b",(function(){return n})),t.d(a,"c",(function(){return r})),t.d(a,"a",(function(){return i}));var i={uniForms:t("bd05").default,uniFormsItem:t("7283").default,uniFilePicker:t("86f5").default,uniEasyinput:t("c4cf").default,uniDatetimePicker:t("e342").default},n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-uni-view",{staticClass:"uni-container"},[t("uni-forms",{ref:"form",attrs:{value:e.formData,"validate-trigger":"submit","err-show-type":"toast"}},[t("uni-forms-item",{attrs:{name:"medicine_imgs",label:"药品外包装图片"}},[t("uni-file-picker",{attrs:{"auto-upload":!0,mode:"grid",limit:3,"file-mediatype":"image"},model:{value:e.formData.medicine_imgs,callback:function(a){e.$set(e.formData,"medicine_imgs",a)},expression:"formData.medicine_imgs"}})],1),t("uni-forms-item",{attrs:{name:"specification_img",label:"药品说明书图片"}},[t("uni-file-picker",{attrs:{"auto-upload":!0,mode:"grid",limit:1,"file-mediatype":"image"},model:{value:e.formData.specification_img,callback:function(a){e.$set(e.formData,"specification_img",a)},expression:"formData.specification_img"}})],1),t("uni-forms-item",{attrs:{name:"generic_name",label:"通用名",required:!0}},[t("uni-easyinput",{attrs:{placeholder:"通用名",trim:"both"},model:{value:e.formData.generic_name,callback:function(a){e.$set(e.formData,"generic_name",a)},expression:"formData.generic_name"}})],1),t("uni-forms-item",{attrs:{name:"medicine_name",label:"药品名称",required:!0}},[t("uni-easyinput",{attrs:{placeholder:"药品名称",trim:"both"},model:{value:e.formData.medicine_name,callback:function(a){e.$set(e.formData,"medicine_name",a)},expression:"formData.medicine_name"}})],1),t("uni-forms-item",{attrs:{name:"medicine_type",label:"药品类型"}},[t("uni-easyinput",{attrs:{placeholder:"药品类型",trim:"both"},model:{value:e.formData.medicine_type,callback:function(a){e.$set(e.formData,"medicine_type",a)},expression:"formData.medicine_type"}})],1),t("uni-forms-item",{attrs:{name:"specification_packaging",label:"规格包装"}},[t("uni-easyinput",{attrs:{placeholder:"规格包装",trim:"both"},model:{value:e.formData.specification_packaging,callback:function(a){e.$set(e.formData,"specification_packaging",a)},expression:"formData.specification_packaging"}})],1),t("uni-forms-item",{attrs:{name:"price",label:"单价"}},[t("uni-easyinput",{attrs:{placeholder:"单价",type:"number"},model:{value:e.formData.price,callback:function(a){e.$set(e.formData,"price",a)},expression:"formData.price"}})],1),t("uni-forms-item",{attrs:{name:"medicine_form",label:"剂型"}},[t("uni-easyinput",{attrs:{placeholder:"剂型",trim:"both"},model:{value:e.formData.medicine_form,callback:function(a){e.$set(e.formData,"medicine_form",a)},expression:"formData.medicine_form"}})],1),t("uni-forms-item",{attrs:{name:"usage_dosage",label:"用法用量"}},[t("uni-easyinput",{attrs:{placeholder:"例如：口服，一次20mg，一日3次",trim:"both"},model:{value:e.formData.usage_dosage,callback:function(a){e.$set(e.formData,"usage_dosage",a)},expression:"formData.usage_dosage"}})],1),t("uni-forms-item",{attrs:{name:"treatment_course",label:"疗程"}},[t("uni-easyinput",{attrs:{placeholder:"例如：三个月",trim:"both"},model:{value:e.formData.treatment_course,callback:function(a){e.$set(e.formData,"treatment_course",a)},expression:"formData.treatment_course"}})],1),t("uni-forms-item",{attrs:{name:"manufacturer",label:"厂家"}},[t("uni-easyinput",{attrs:{placeholder:"生产厂家",trim:"both"},model:{value:e.formData.manufacturer,callback:function(a){e.$set(e.formData,"manufacturer",a)},expression:"formData.manufacturer"}})],1),t("uni-forms-item",{attrs:{name:"approval_number",label:"批准文号"}},[t("uni-easyinput",{attrs:{placeholder:"批准文号",trim:"both"},model:{value:e.formData.approval_number,callback:function(a){e.$set(e.formData,"approval_number",a)},expression:"formData.approval_number"}})],1),t("uni-forms-item",{attrs:{name:"production_date",label:"生产日期"}},[t("uni-datetime-picker",{attrs:{"return-type":"timestamp"},model:{value:e.formData.production_date,callback:function(a){e.$set(e.formData,"production_date",a)},expression:"formData.production_date"}})],1),t("uni-forms-item",{attrs:{name:"valid_until",label:"有效期至"}},[t("uni-datetime-picker",{attrs:{"return-type":"timestamp"},model:{value:e.formData.valid_until,callback:function(a){e.$set(e.formData,"valid_until",a)},expression:"formData.valid_until"}})],1),t("uni-forms-item",{attrs:{name:"is_on_sale",label:"是否上架"}},[t("v-uni-switch",{attrs:{checked:e.formData.is_on_sale},on:{change:function(a){arguments[0]=a=e.$handleEvent(a),e.binddata("is_on_sale",a.detail.value)}}})],1),t("v-uni-view",{staticClass:"uni-button-group"},[t("v-uni-button",{staticClass:"uni-button",attrs:{type:"primary"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.submit.apply(void 0,arguments)}}},[e._v("提交")])],1)],1)],1)},r=[]},"8fc3":function(e,a,t){var i=t("ff16");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=t("4f06").default;n("7d7da601",i,!0,{sourceMap:!1,shadowMode:!1})},"91c6":function(e,a,t){"use strict";var i=t("8fc3"),n=t.n(i);n.a},fa11:function(e,a,t){"use strict";t.r(a);var i=t("69fa"),n=t("65a8");for(var r in n)"default"!==r&&function(e){t.d(a,e,(function(){return n[e]}))}(r);t("91c6");var o,s=t("f0c5"),u=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"7367e96b",null,!1,i["a"],o);a["default"]=u.exports},fa35:function(e,a,t){"use strict";var i=t("4ea4");t("4d63"),t("ac1f"),t("25f0"),Object.defineProperty(a,"__esModule",{value:!0}),a.filterToWhere=u,a.enumConverter=a.validator=void 0;var n=i(t("3835")),r=i(t("b85c")),o={medicine_imgs:{rules:[{format:"array"}],label:"药品外包装图片"},specification_img:{rules:[{format:"array"}],label:"药品说明书图片"},generic_name:{rules:[{required:!0},{format:"string"}],label:"通用名"},medicine_name:{rules:[{required:!0},{format:"string"}],label:"药品名称"},medicine_type:{rules:[{format:"string"}],label:"药品类型"},specification_packaging:{rules:[{format:"string"}],label:"规格包装"},price:{rules:[{format:"int"}],label:"单价"},medicine_form:{rules:[{format:"string"}],label:"剂型"},usage_dosage:{rules:[{format:"string"}],label:"用法用量"},treatment_course:{rules:[{format:"string"}],label:"疗程"},manufacturer:{rules:[{format:"string"}],label:"厂家"},approval_number:{rules:[{format:"string"}],label:"批准文号"},production_date:{rules:[{format:"timestamp"}],label:"生产日期"},valid_until:{rules:[{format:"timestamp"}],label:"有效期至"},is_on_sale:{rules:[{format:"bool"}],defaultValue:!0,label:"是否上架"}};a.validator=o;var s={};function u(e,a){var t={};for(var i in e){var o=e[i],s=o.type,u=o.value;switch(s){case"search":"string"===typeof u&&u.length&&(t[i]=new RegExp(u));break;case"select":if(u.length){var l,c=[],m=(0,r.default)(u);try{for(m.s();!(l=m.n()).done;){var f=l.value;c.push(a.eq(f))}}catch(x){m.e(x)}finally{m.f()}t[i]=a.or(c)}break;case"range":if(u.length){var d=u[0],p=u[1];t[i]=a.and([a.gte(d),a.lte(p)])}break;case"date":if(u.length){var b=(0,n.default)(u,2),g=b[0],_=b[1],v=new Date(g),h=new Date(_);t[i]=a.and([a.gte(v),a.lte(h)])}break;case"timestamp":if(u.length){var D=(0,n.default)(u,2),y=D[0],k=D[1];t[i]=a.and([a.gte(y),a.lte(k)])}break}}return t}a.enumConverter=s},ff16:function(e,a,t){var i=t("24fb");a=i(!1),a.push([e.i,".uni-container[data-v-7367e96b]{background-color:#fff;padding:15px}.uni-input-border[data-v-7367e96b],\n.uni-textarea-border[data-v-7367e96b]{width:100%;font-size:14px;color:#666;border:1px #e5e5e5 solid;border-radius:5px;box-sizing:border-box}.uni-input-border[data-v-7367e96b]{padding:0 10px;height:35px}.uni-textarea-border[data-v-7367e96b]{padding:10px;height:80px}.uni-button-group[data-v-7367e96b]{margin-top:50px;\ndisplay:flex;\njustify-content:center}.uni-button[data-v-7367e96b]{width:184px;padding:12px 20px;font-size:14px;border-radius:4px;line-height:1;margin:0}",""]),e.exports=a}}]);